# Covert Storage Channel that exploits Packet Bursting using TCP

This project implements a covert storage channel that exploits TCP packet bursting for data transmission. The communication uses bursts of TCP packets to encode binary messages, with the sender transmitting packet bursts and the receiver decoding the bursts based on specified ranges.

## Project Structure

The project contains the following key components:

### **Files**:

- **MyCovertChannel.py**: Contains the implementation of the `MyCovertChannel` class, inheriting from `CovertChannelBase`.
- **CovertChannelBase.py**: Provides base methods for sending packets, logging, and other utility functions.
- **config.json**: Defines configuration parameters for the sender and receiver.
- **Makefile**: Facilitates running the sender and receiver, comparing logs, and generating documentation.
- **run.py**: Main script to execute the sender or receiver based on the argument passed.

### **Classes**:

#### `CovertChannelBase`
- Handles:
  - Sending packets using Scapy (`send` method).
  - Logging messages (`log_message` method).
  - Generating random binary messages.
  - Utility functions for encoding and decoding messages.

#### `MyCovertChannel`
- Implements the sender and receiver logic.
- Defines methods to:
  - Send bursts of packets representing binary data.
  - Decode received packets and reconstruct the original message.

## Functionality Overview

### **Sender (`MyCovertChannel.send`)**

- Reads configuration from `config.json`.
- Generates a random binary message using `generate_random_binary_message_with_logging`.
- Splits the binary message into chunks of 8 bits.
- For each chunk in a chunks:
    - Shuffle the index_range list with the current seed
    - For each bit in a chunk in random order:
        - Finds the corresponding burst range from index_range.
        - Determines the number of packets to send randomly on the interval founded on previous step.
        - Sends the burst of packets to a specified destination.
        - Increment seed with selected bit

### **Receiver (`MyCovertChannel.receive`)**

- Listens for incoming packets on a specified port.
- Tracks idle time to detect the end of a burst.
- Decodes bursts into bits based on packet count ranges based on index_range list.
- Increment random seed with received bit's calculated index value
- Return to listening again
- Reconstructs the binary message and converts it into a readable string.
- Logs the received message.

## Configuration

The `config.json` file specifies the parameters for the sender and receiver:

### **Send Parameters**:
```json
{
  "log_file_name": "ChannelSender.log",
  "idle_time": 0.2,
  "index_range": [
    [1, 3], [4, 6], [7, 9], [10, 12],
    [13, 15], [16, 18], [19, 21], [22, 24],
    [25, 27], [28, 30], [31, 33], [34, 36],
    [37, 39], [40, 42], [43, 45], [46, 48]
  ],
  "random_seed": 32
}
```

### **Receive Parameters**:
```json
{
  "idle_threshold": 0.19,
  "log_file_name": "ChannelReceiver.log",
  "index_range": [
    [1, 3], [4, 6], [7, 9], [10, 12],
    [13, 15], [16, 18], [19, 21], [22, 24],
    [25, 27], [28, 30], [31, 33], [34, 36],
    [37, 39], [40, 42], [43, 45], [46, 48]
  ],
  "random_seed": 32,
  "timeout": 0.6
}
```

## Usage

### **1. Setup**
- Ensure Docker is installed and running on your system.

### **2. Build and Run**

1. Start the containers:
   ```bash
   docker-compose up
   ```
2. To start the receiver:
   ```bash
   make receive
   ```
3. To start the sender:
   ```bash
   make send
   ```

### **3. Verify Logs**
Compare the logs generated by the sender and receiver to ensure the communication was successful:
```bash
make compare
```

## Key Notes

1. **Packet Transmission:**
   - The sender uses a specified idle time between bursts to differentiate them.
   - The receiver decodes bursts by counting packets and mapping them to binary values based on configured ranges.

2. **Process Termination:**
   - The receiver terminates sniffing if no packets are received within the specified timeout.

3. **Randomization:**
   - Both sender and receiver use a consistent random seed to shuffle index ranges for encoding/decoding.

## Limitations and Assumptions

- **Assumptions:**
  - The network delays are minimal and do not affect burst detection significantly.
  - The `config.json` file is correctly formatted and accessible.
  - Covert Channel Capacity: 3.28 bits/second


## Authors
- Melih Arda Metin
- Fehmi Tunahan Gümüş

